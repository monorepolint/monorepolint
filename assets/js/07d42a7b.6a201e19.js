"use strict";(self.webpackChunk_monorepolint_docs=self.webpackChunk_monorepolint_docs||[]).push([[276],{712:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var s=t(6364);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}},7979:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"tips-and-tricks","title":"Tips and Tricks","description":"Using the REMOVE Symbol","source":"@site/docs/tips-and-tricks.md","sourceDirName":".","slug":"/tips-and-tricks","permalink":"/docs/tips-and-tricks","draft":false,"unlisted":false,"editUrl":"https://github.com/monorepolint/monorepolint/edit/main/packages/docs/docs/tips-and-tricks.md","tags":[],"version":"current","frontMatter":{"title":"Tips and Tricks"},"sidebar":"docs","previous":{"title":"Putting your Config in a Package","permalink":"/docs/guides/config-in-a-package"},"next":{"title":"alphabeticalDependencies","permalink":"/docs/rules/alphabetical-dependencies"}}');var i=t(1360),r=t(712);const o={title:"Tips and Tricks"},c=void 0,a={},l=[{value:"Using the REMOVE Symbol",id:"using-the-remove-symbol",level:2},{value:"Benefits of REMOVE",id:"benefits-of-remove",level:3},{value:"Supported Rules",id:"supported-rules",level:3},{value:"Migration Cleanup Example",id:"migration-cleanup-example",level:3},{value:"Standardizing package.json Exports",id:"standardizing-packagejson-exports",level:2},{value:"Pre-formatting Generated Content with dprint",id:"pre-formatting-generated-content-with-dprint",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"using-the-remove-symbol",children:"Using the REMOVE Symbol"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"REMOVE"})," symbol provides a clean way to remove entries, dependencies, scripts, and files across your monorepo. Import it from ",(0,i.jsx)(n.code,{children:"@monorepolint/rules"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'import { REMOVE } from "@monorepolint/rules";\n'})}),"\n",(0,i.jsx)(n.h3,{id:"benefits-of-remove",children:"Benefits of REMOVE"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Explicit Intent"}),": Makes removal operations explicit and intentional"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Conditional Behavior"}),": Only reports errors when items exist, avoiding noise"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Clean Configuration"}),": More readable than legacy ",(0,i.jsx)(n.code,{children:"undefined"})," approaches"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type Safety"}),": Provides better TypeScript support"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"supported-rules",children:"Supported Rules"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"REMOVE"})," symbol works with these rules:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"fileContents"}),": Remove files from packages"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"packageScript"}),": Remove scripts from package.json"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"requireDependency"}),": Remove dependencies from package.json"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"packageEntry"}),": Remove arbitrary fields from package.json"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"migration-cleanup-example",children:"Migration Cleanup Example"}),"\n",(0,i.jsxs)(n.p,{children:["Here's a comprehensive example showing how to use ",(0,i.jsx)(n.code,{children:"REMOVE"})," for migrating from Jest to Vitest:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'import {\n  fileContents,\n  packageScript,\n  REMOVE,\n  requireDependency,\n} from "@monorepolint/rules";\n\nexport default {\n  rules: [\n    // Remove Jest configuration files\n    fileContents({\n      options: {\n        file: "jest.config.js",\n        template: REMOVE,\n      },\n    }),\n    fileContents({\n      options: {\n        file: "jest.config.json",\n        template: REMOVE,\n      },\n    }),\n\n    // Remove Jest scripts\n    packageScript({\n      options: {\n        scripts: {\n          jest: REMOVE,\n          "jest:watch": REMOVE,\n          "test:jest": REMOVE,\n        },\n      },\n    }),\n\n    // Remove Jest dependencies\n    requireDependency({\n      options: {\n        devDependencies: {\n          jest: REMOVE,\n          "@types/jest": REMOVE,\n          "ts-jest": REMOVE,\n          "jest-environment-jsdom": REMOVE,\n        },\n      },\n    }),\n\n    // Add Vitest configuration and dependencies\n    fileContents({\n      options: {\n        file: "vitest.config.mjs",\n        templateFile: "./templates/vitest.config.mjs",\n      },\n    }),\n    packageScript({\n      options: {\n        scripts: {\n          test: "vitest run --passWithNoTests",\n          "test:watch": "vitest --passWithNoTests",\n        },\n      },\n    }),\n    requireDependency({\n      options: {\n        devDependencies: {\n          vitest: "^1.0.0",\n          "@vitest/ui": "^1.0.0",\n        },\n      },\n    }),\n  ],\n};\n'})}),"\n",(0,i.jsx)(n.h2,{id:"standardizing-packagejson-exports",children:"Standardizing package.json Exports"}),"\n",(0,i.jsxs)(n.p,{children:["To maintain consistency across packages, it is recommended to define a standard for exports, such as mapping all files in the ",(0,i.jsx)(n.code,{children:"public/"})," directory as root exports. This can be achieved by using the following configuration:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'packageEntry({\n  options: {\n    entries: {\n      exports: {\n        ".": {\n          types: "./dist/index.d.ts",\n          import: "./dist/index.mjs",\n          require: "./dist/index.js",\n        },\n        "./*": {\n          types: "./dist/public/*.d.ts",\n          import: "./dist/public/*.mjs",\n          require: "./dist/public/*.js",\n        },\n      },\n    },\n  },\n}),\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This configuration can be combined with tools like ",(0,i.jsx)(n.code,{children:"tsup"})," to automatically bundle exports:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    ...\n    "entry": ["src/index.ts", "src/public/*.ts"]\n    ...\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"pre-formatting-generated-content-with-dprint",children:"Pre-formatting Generated Content with dprint"}),"\n",(0,i.jsxs)(n.p,{children:["Pre-formatting generated content using ",(0,i.jsx)(n.a,{href:"https://dprint.dev/",children:"dprint"})," can be challenging since it cannot be used directly from node. However, it is possible to create wrappers by executing it in a shell:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'const formatWithDprint = (contents, ext) => async (context) => {\n  const result = child_process.spawnSync(\n    `pnpm exec dprint fmt --stdin foo.${ext}`,\n    {\n      input: contents,\n      encoding: "utf8",\n      shell: true,\n    },\n  );\n\n  if (result.error) {\n    throw result.error;\n  }\n  return result.stdout;\n};\n'})}),"\n",(0,i.jsx)(n.p,{children:"By utilizing this wrapper, you can ensure that your files are properly formatted:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const tsupContents = formatWithDprint(\n  `\n  import { defineConfig } from "tsup";\n\n  export default defineConfig(async (options) =>\n  (await import("mytsup")).default(options)\n  );     \n`,\n  "js",\n);\n\n// ...\n\nreturn [\n  fileContents({\n    ...shared,\n    options: {\n      file: "tsup.config.js",\n      template: tsupContents,\n    },\n  }),\n];\n'})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);